---
title: "Project"
output: html_document
date: "2025-02-12"
---

```{r Imporing Business Data}
library(terra)
library(tidyverse)


bis <- read.csv("Registered_Business_Locations_-_San_Francisco_20250212.csv", sep = ";")
regex1 <- "POINT \\("
bis$Business.Location <- gsub(regex1, "", bis$Business.Location)
bis$Business.Location

regex2 <- "\\)"
bis$Business.Location <- gsub(regex2, "", bis$Business.Location)
bis$Business.Location

bis_lonlat <- bis %>%
  separate(Business.Location, c("lon", "lat"), sep = " ") %>%
  mutate(lon = as.numeric(lon),
         lat = as.numeric(lat))

bisv <- vect(bis_lonlat, geom = c("lon", "lat"))
```

```{r Cropping to City Extent}
muni<- vect("geo_export_7a61b6cd-add6-411a-bdc0-6a4be0880140.dbf")
muni

newv <- vect("geo_export_674028c8-64b1-47df-a16d-14009ac491a7.dbf")
newv

count <- terra::extract(newv, bisv)
counts <- sapply(count, length)

noNAcount <- count %>%
  filter(!is.na(nhood))

neighborhood <- noNAcount%>%
  group_by(nhood) %>%
  summarize(point_count = n())

join <- merge(newv, neighborhood, by="nhood")

```

```{r Plotting Business, Muni Stops and City Extent}
plot(newv)
plot(join, "point_count", col = rainbow(50))
##plot(bisv, add=TRUE, cex=0.1)
##plot(muni, add=TRUE, cex=0.2, col="blue")
?plot
```



